{% load static %}
<!DOCTYPE html>
<html>

<head>
    <title >Pecktra</title>
    <meta charset="utf-8">


    <!-- <link href="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/css/bootstrap.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">

    <link rel="stylesheet" type="text/css" href="{% static 'css/nav.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/chat.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/user_chat.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/move_v2.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/streamer.css' %}">
    <!-- Bootstrap Icons -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"> -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-icons.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <!-- Bootstrap 5 CSS -->


    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
            overflow: hidden;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
</head>
<body>
<svg xmlns="https://www.w3.org/2000/svg" style="display: none;">
    <symbol id="bootstrap" viewBox="0 0 118 94">
        <title>Bootstrap</title>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z"></path>
    </symbol>
    <symbol id="home" viewBox="0 0 16 16">
        <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
    </symbol>
    <symbol id="speedometer2" viewBox="0 0 16 16">
        <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
        <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z"/>
    </symbol>
    <symbol id="table" viewBox="0 0 16 16">
        <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 2h-4v3h4V4zm0 4h-4v3h4V8zm0 4h-4v3h3a1 1 0 0 0 1-1v-2zm-5 3v-3H6v3h4zm-5 0v-3H1v2a1 1 0 0 0 1 1h3zm-4-4h4V8H1v3zm0-4h4V4H1v3zm5-3v3h4V4H6zm4 4H6v3h4V8z"/>
    </symbol>
    <symbol id="people-circle" viewBox="0 0 16 16">
        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
        <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
    </symbol>
    <symbol id="grid" viewBox="0 0 16 16">
        <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
    </symbol>
</svg>
<main>
    <!--左侧导航-->
		<div class="d-flex flex-column flex-shrink-0 p-3 text-white bg-dark nav-sidebar" style="width: 280px;">


                <div class="d-flex align-items-center justify-content-between">
                    <a href="/" class="d-flex align-items-center text-white text-decoration-none">
                        <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
                        <span class="fs-4">Pecktra</span>
                    </a>
                    <button class="close-nav mobile-only" title="关闭导航">
                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
			<hr>
			<ul class="nav nav-pills flex-column mb-auto">
				<!-- <li>
					<a href="/api/live/redirect_to_random_room" class="nav-link text-white home-link" data-bs-toggle="tooltip" data-bs-placement="right" title="Home">
						<svg class="bi me-2" width="16" height="16"><use xlink:href="#speedometer2"/></svg>
						Home
					</a>
				</li> -->
				<li>
					<a href="#" class="nav-link text-white build-universe" data-bs-toggle="tooltip" data-bs-placement="right" title="Build Universe">
						<svg class="bi me-2" width="16" height="16"><use xlink:href="#speedometer2"/></svg>
						Build Universe
					</a>
				</li>
				<li>
					<a href="#" class="nav-link text-white room-link" data-bs-toggle="tooltip" data-bs-placement="right" title="Room">
						<svg class="bi me-2" width="16" height="16"><use xlink:href="#table"/></svg>
						Universes
					</a>
				</li>
            <li>
                <a href="#" class="nav-link text-white follows-link" data-bs-toggle="tooltip" data-bs-placement="right" title="Follows">
                    <svg class="bi me-2" width="16" height="16"><use xlink:href="#people-circle"/></svg>
                    Favourite
                </a>
            </li>
            <li>
                <a href="#" class="nav-link text-white subscriptions-link" data-bs-toggle="tooltip" data-bs-placement="right" title="Subscriptions">
                    <svg class="bi me-2" width="16" height="16"><use xlink:href="#grid"/></svg>
                    Subscriptions
                </a>
            </li>

			</ul>
			<hr>
			<h6 class="text-white mb-2">Live Universes</h6>
			<div class="scrollarea" id="liveListContainer">
				<!-- 静态占位内容可以保留作为加载状态 -->
				<div class="text-center py-3 text-white" id="loadingIndicator">
					<div class="spinner-border spinner-border-sm" role="status">
						<span class="visually-hidden">Loading...</span>
					</div>
					正在加载直播列表...
				</div>

				<!-- 动态内容将由JavaScript填充 -->
			</div>
			<hr>
			<!-- <div class="dropdown">
				<a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
					<strong id="username">Loading...</strong>
				</a>
				<ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
					<li><a class="dropdown-item" href={{ build_universe_url }} id="profileLink">Build Universe</a></li>
					<li><hr class="dropdown-divider"></li>
					<li><a class="dropdown-item" href="#" id="logoutLink">Sign out</a></li>
					<li><a class="dropdown-item" href="#" id="googleLoginLink" >Sign in with Google</a></li>
				</ul>
			</div> -->
            <div class="auth-buttons">
                <a href="#" class="btn btn-primary" id="googleLoginLink" style="display: none;">Sign in with Google</a>
                <a href="#" class="btn btn-secondary" id="logoutLink" style="display: none;">Sign out</a>
            </div>
		</div>
















{% block content %}

{% endblock %}








</main>

<!-- 打赏模态框 -->
<div class="modal fade" id="rewardModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Tip the streamer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="rewardForm">
          <div class="mb-3">
            <label for="rewardAmount" class="form-label">Donation amount</label>
            <div class="input-group">
              <span class="input-group-text">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="#FFD700" style="margin-right: 6px;">
                    <path d="M12 1.5L6 9H18L12 1.5ZM6 9L1 15H23L18 9H6ZM1 15L6 21H18L23 15H1ZM12 15L9 9H15L12 15Z"/>
                </svg>

              </span>
              <input type="number" class="form-control" id="rewardAmount"
                     min="1" step="1" required>
            </div>
          </div>

          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">cancel</button>
            <button type="submit" class="btn btn-primary">Confirm</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

    <!-- Follows Modal -->
    <div class="modal fade" id="followsModal" tabindex="-1" aria-labelledby="followsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="followsModalLabel">我的关注</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="关闭"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-table-container">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>房间名称</th>
                                    <th>关注时间</th>

                                </tr>
                            </thead>
                            <tbody id="followsTable">
                                <tr><td colspan="2">加载中...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>




    <!-- Subscriptions Modal -->
    <div class="modal fade" id="subscriptionsModal" tabindex="-1" aria-labelledby="subscriptionsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="subscriptionsModalLabel">我的订阅</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="关闭"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-table-container">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>主播ID</th>
                                    <th>主播名称</th>
                                    <th>支付钻石</th>
                                    <th>订阅时间</th>
                                    <th>订阅结束时间</th>
                                </tr>
                            </thead>
                            <tbody id="subscriptionsTable">
                                <tr><td colspan="5">加载中...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>




<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script> -->
<script>
  // 将 room_id 暴露为全局变量

  window.GLOBAL_ROOM_ID = "{{ room_id }}";


</script>
<!-- <script src="https://app.unpkg.com/js-md5@0.8.3/files/build/md5.min.js"></script>
<script src="https://unpkg.com/identicon.js@2.3.3/lib/identicon.min.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script> -->
<script src="{% static 'js/marked.min.js' %}"></script>
<script src="{% static 'js/moment.min.js' %}"></script>
<script src="{% static 'js/vh-check.min.js' %}"></script>
<!-- <script src="https://cdn.staticfile.net/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script> -->
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
<script type="module" src="{% static 'js/script.mjs' %}"></script>
<script type="module" src="{% static 'js/main.mjs' %}"></script>
   <script>
document.addEventListener('DOMContentLoaded', () => {
    const main = document.querySelector('main');
    const navSidebar = document.querySelector('.nav-sidebar');
    // const totalChat = document.querySelector('.total-chat');
    const closeNavBtn = document.querySelector('.close-nav');
    const closeChatBtn = document.querySelector('.close-chat');
    const switchToNavBtn = document.querySelector('.switch-to-nav');
    const switchToChatBtn = document.querySelector('.switch-to-chat');

    function showSection(section) {
        if (!section) {
            console.error('Section is undefined');
            return;
        }
        // [navSidebar, totalChat].forEach(el => {
        //     if (el) {
        //         const displayValue = (el === section) ? 'flex' : 'none';
        //         el.style.setProperty('display', displayValue, 'important');
        //     } else {
        //         console.error('Element is undefined:', el);
        //     }
        // });
        [navSidebar].forEach(el => {
            if (el) {
                const displayValue = (el === section) ? 'flex' : 'none';
                el.style.setProperty('display', displayValue, 'important');
            } else {
                console.error('Element is undefined:', el);
            }
        });
        // 如果显示聊天区域，滚动到最新消息
        // if (section === totalChat) {
        //     const chatContainer = document.querySelector('.chat-content');
        //     if (chatContainer) {
        //         chatContainer.scrollTop = chatContainer.scrollHeight;
        //     }
        // }
    }

    // 获取 Home 链接并添加点击事件
        const homeLink = document.querySelector('.home-link');
        if (homeLink) {
            homeLink.addEventListener('click', (e) => {
                e.preventDefault(); // 阻止默认跳转
                window.location.href = '/'; // 跳转到主页
            });
        }

    // 获取 Home 链接并添加点击事件
        const BuildUniverseLink = document.querySelector('.build-universe');
        if (BuildUniverseLink) {
            BuildUniverseLink.addEventListener('click', (e) => {
                e.preventDefault(); // 阻止默认跳转
                window.open("{{ build_universe_url }}", "_blank") // 跳转st
            });
        }


    // // 仅在手机端（<= 768px）应用切换逻辑
    // if (window.innerWidth <= 768) {
    //     // 默认显示聊天区域
    //     showSection(totalChat);

    //     if (closeNavBtn) {
    //         closeNavBtn.addEventListener('click', (event) => {
    //             event.preventDefault();
    //             event.stopPropagation();
    //             showSection(totalChat);
    //         });
    //     }

    //     if (closeChatBtn) {
    //         closeChatBtn.addEventListener('click', (event) => {
    //             event.preventDefault();
    //             event.stopPropagation();
    //             showSection(totalChat);
    //         });
    //     }

    //     if (switchToNavBtn) {
    //         switchToNavBtn.addEventListener('click', (event) => {
    //             event.preventDefault();
    //             event.stopPropagation();
    //             showSection(navSidebar);
    //         });
    //     }

    //     if (switchToChatBtn) {
    //         switchToChatBtn.addEventListener('click', (event) => {
    //             event.preventDefault();
    //             event.stopPropagation();
    //             showSection(totalChat);
    //         });
    //     }

    //     // Fallback binding for mobile devices
    //     setTimeout(() => {
    //         const fallbackSwitchToNavBtn = document.querySelector('.switch-to-nav');
    //         const fallbackSwitchToChatBtn = document.querySelector('.switch-to-chat');
    //         if (fallbackSwitchToNavBtn && !fallbackSwitchToNavBtn.onclick) {
    //             fallbackSwitchToNavBtn.addEventListener('click', (event) => {
    //                 event.preventDefault();
    //                 event.stopPropagation();
    //                 showSection(navSidebar);
    //             });
    //         }
    //         if (fallbackSwitchToChatBtn && !fallbackSwitchToChatBtn.onclick) {
    //             fallbackSwitchToChatBtn.addEventListener('click', (event) => {
    //                 event.preventDefault();
    //                 event.stopPropagation();
    //                 showSection(totalChat);
    //             });
    //         }
    //     }, 1000);
    // }
});












// 获取按钮和拟态框元素
    if(window.GLOBAL_ROOM_ID != "None"){
        const openPayModalBtn = document.getElementById('open-pay-modal');
        const payModal = document.getElementById('pay-modal');
        const closePayModalBtn = document.getElementById('close-pay-modal');

        // 点击“+”按钮显示拟态框
        openPayModalBtn.addEventListener('click', () => {
            payModal.style.display = 'block';
        });

        // 点击“取消”按钮关闭拟态框
        closePayModalBtn.addEventListener('click', () => {
            payModal.style.display = 'none';
        });

        // 可选：点击背景关闭拟态框
        payModal.addEventListener('click', (e) => {
            if (e.target === payModal) {
                payModal.style.display = 'none';
            }
        })
    }













    </script>
</body>
</html>
